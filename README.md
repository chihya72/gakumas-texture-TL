# Gakumas è´´å›¾ç¿»è¯‘æ’ä»¶ (XInputç‰ˆæœ¬)

ä¸€ä¸ªåŸºäºDLLåŠ«æŒæŠ€æœ¯çš„Unity IL2CPPè´´å›¾ç¿»è¯‘æ’ä»¶ï¼Œä¸“ä¸ºå­¦å›­å¶åƒå¤§å¸ˆ (Gakumas) æ¸¸æˆè®¾è®¡ï¼Œç›®å‰æ”¯æŒæ¼«ç”»ã€åŸ¹è‚²æŠ¥å‘Šã€UIæŒ‰é’®å’Œæ•™ç¨‹å›¾åƒçš„æœ¬åœ°åŒ–æ›¿æ¢ã€‚

## ğŸ¯ é¡¹ç›®ç‰¹è‰²

- âœ… **éä¾µå…¥å¼æ›¿æ¢**: æ— éœ€ä¿®æ”¹æ¸¸æˆæ–‡ä»¶ï¼Œé€šè¿‡DLLåŠ«æŒå®ç°
- âœ… **å¤šç±»å‹æ”¯æŒ**: æ¼«ç”»ã€General Reportã€UIæŒ‰é’®ã€æ•™ç¨‹å›¾åƒ
- âœ… **å…¼å®¹æ€§ä¼˜ç§€**: ä¸chinoskçš„version.dllæ±‰åŒ–è¡¥ä¸å®Œç¾å¹¶è¡Œè¿è¡Œ  
- âœ… **å®‰å…¨ç¨³å®š**: ä½¿ç”¨XInput1_3.dllï¼Œä¸å½±å“å…³é”®ç³»ç»ŸåŠŸèƒ½
- âœ… **æ€§èƒ½ä¼˜åŒ–**: æ™ºèƒ½ç¼“å­˜å’Œå†…å­˜ç®¡ç†ï¼Œåªç›‘æ§å·²é…ç½®èµ„æº
- âœ… **å®æ—¶æ—¥å¿—**: è¯¦ç»†çš„æ›¿æ¢æ—¥å¿—ï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§
- ğŸ”„ **æŒç»­æ›´æ–°**: æœ¬ä»“åº“ä¼šå®šæœŸæ›´æ–°ç¿»è¯‘èµ„æºï¼ŒReleaseç‰ˆæœ¬åŒ…å«æœ€æ–°ç¿»è¯‘

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…æ­¥éª¤

1. **ä¸‹è½½Releaseç‰ˆæœ¬**
   ```
   ä¸‹è½½å®Œæ•´ReleaseåŒ…ï¼ŒåŒ…å«ï¼š
   - xinput1_3.dll (æ’ä»¶æœ¬ä½“)
   - gakumas-local-texture/ (é¢„ç½®ç¿»è¯‘èµ„æº)
   å°†å…¨éƒ¨æ–‡ä»¶è§£å‹åˆ°æ¸¸æˆæ ¹ç›®å½•
   ```

2. **ç¡®è®¤èµ„æºç›®å½•ç»“æ„**
   ```
   gakumas.exeæ‰€åœ¨ç›®å½•/
   â”œâ”€â”€ gakumas.exe
   â”œâ”€â”€ version.dll              # chinoskæ±‰åŒ–è¡¥ä¸ (å¯é€‰)
   â”œâ”€â”€ xinput1_3.dll            # è´´å›¾ç¿»è¯‘æ’ä»¶
   â””â”€â”€ gakumas-local-texture/   # èµ„æºç›®å½• (Releaseä¸­å·²åŒ…å«)
       â”œâ”€â”€ asset_mapping.txt    # é…ç½®æ–‡ä»¶ (å·²é¢„é…ç½®)
       â”œâ”€â”€ comic/              # æ¼«ç”»å›¾åƒ (å«ä½œè€…ç¿»è¯‘)
       â”œâ”€â”€ general_report/     # åŸ¹è‚²æŠ¥å‘Šå›¾åƒ (å«ä½œè€…ç¿»è¯‘)
       â”œâ”€â”€ ui/                 # UIæŒ‰é’®å›¾åƒ (å«ä½œè€…ç¿»è¯‘)
       â””â”€â”€ tutorial/           # æ•™ç¨‹å›¾åƒ (å«ä½œè€…ç¿»è¯‘)
   ```

3. **è‡ªå®šä¹‰å›¾åƒæ˜ å°„ (å¯é€‰)**
   
   **æ³¨æ„**: Releaseç‰ˆæœ¬å·²åŒ…å«ä½œè€…ç¿»è¯‘çš„å›¾åƒèµ„æºå’Œé¢„é…ç½®æ–‡ä»¶ï¼Œå¯ç›´æ¥ä½¿ç”¨ã€‚
   å¦‚éœ€è‡ªå®šä¹‰æˆ–æ·»åŠ æ›´å¤šç¿»è¯‘ï¼Œå¯ç¼–è¾‘ `gakumas-local-texture/asset_mapping.txt`:
   ```ini
   # æ¼«ç”»æ›¿æ¢
   img_general_comic_0001=comic/1ko/my_comic_01.png
   img_general_comic_0002=comic/1ko/my_comic_02.png
   
   # General Reportæ›¿æ¢
   img_general_report_text_ttmr-001=general_report/text_ttmr_001_cn.png
   img_general_report_photo-name_ttmr-001=general_report/name_ttmr_001_cn.png
   
   # UIæŒ‰é’®æ›¿æ¢ (åŸºäºå®é™…æ£€æµ‹åˆ°çš„èµ„æºå)
   img_general_ui_produce-1_btn-small=ui/produce_1_btn_small_cn.png
   img_general_ui_produce-nia_btn=ui/produce_nia_btn_cn.png
   
   # æ•™ç¨‹å›¾åƒæ›¿æ¢
   img_tutorial_produce_01_first-001=tutorial/produce_tutorial_001_cn.png
   ```

4. **å¯åŠ¨æ¸¸æˆ**
   
   æ­£å¸¸å¯åŠ¨æ¸¸æˆï¼Œç³»ç»Ÿå°†è‡ªåŠ¨ï¼š
   - æ£€æµ‹ç›®æ ‡è¿›ç¨‹ (gakumas.exe)
   - åŠ è½½é…ç½®æ–‡ä»¶
   - å®‰è£…Hookç³»ç»Ÿ
   - å¼€å§‹å›¾åƒæ›¿æ¢

## ğŸ“ é¡¹ç›®ç»“æ„

```
gakumas-texture-TL/
â”œâ”€â”€ xinput1_3_with_general_report.cpp    # ä¸»å®ç°æ–‡ä»¶ (890è¡Œ)
â”œâ”€â”€ xinput1_3.vcxproj                     # Visual Studioé¡¹ç›®
â”œâ”€â”€ xinput1_3.def                         # XInput APIå¯¼å‡ºå®šä¹‰
â”œâ”€â”€ MinHook/                              # Hookåº“ä¾èµ–
â”‚   â”œâ”€â”€ include/MinHook.h
â”‚   â””â”€â”€ lib/libMinHook.x64.lib
â”œâ”€â”€ gakumas-local-texture/                # æ¸¸æˆèµ„æºç›®å½• (æŒç»­æ›´æ–°ä¸­)
â”‚   â”œâ”€â”€ asset_mapping.txt                 # é…ç½®æ–‡ä»¶ (é¢„é…ç½®ä½œè€…ç¿»è¯‘)
â”‚   â”œâ”€â”€ comic/                           # æ¼«ç”»å›¾åƒ (å«ä½œè€…ç¿»è¯‘)
â”‚   â”‚   â”œâ”€â”€ 1ko/                         # ä¸€æ ¼æ¼«ç”»
â”‚   â”‚   â””â”€â”€ 4ko/                         # å››æ ¼æ¼«ç”»
â”‚   â”œâ”€â”€ general_report/                  # åŸ¹è‚²æŠ¥å‘Šå›¾åƒ (å«ä½œè€…ç¿»è¯‘)                                               
â”‚   â”œâ”€â”€ ui/button/                       # UIæŒ‰é’®å›¾åƒ (å«ä½œè€…ç¿»è¯‘)
â”‚   â”œâ”€â”€ tutorial/                        # æ•™ç¨‹å›¾åƒ (å«ä½œè€…ç¿»è¯‘)
â”‚   â””â”€â”€ logs/                            # è‡ªåŠ¨ç”Ÿæˆæ—¥å¿—
â””â”€â”€ prompt_md/                           # å¼€å‘æ–‡æ¡£
    â”œâ”€â”€ Gakumasè´´å›¾ç¿»è¯‘æ’ä»¶ - å®Œæ•´é¡¹ç›®è®°å½•.md
    â”œâ”€â”€ UI_Tutorial_æ‰©å±•å¼€å‘è®°å½•.md
    â””â”€â”€ Chinosk_ida_functions_reference.md
```

## ğŸ”§ æŠ€æœ¯åŸç†

### æ ¸å¿ƒæŠ€æœ¯æ¶æ„

1. **DLLåŠ«æŒ**: ä½¿ç”¨XInput1_3.dllä»£ç†å®ç°å®‰å…¨åŠ«æŒ
2. **IL2CPP Hook**: åŸºäºMinHookåº“Hook Unity IL2CPPå‡½æ•°
3. **å»¶è¿Ÿæ›¿æ¢**: LoadAssetAsyncè®°å½•è¯·æ±‚ï¼ŒGetResultæ‰§è¡Œæ›¿æ¢
4. **æ™ºèƒ½ç¼“å­˜**: çº¹ç†ç¼“å­˜å’Œè¿‡æœŸæ¸…ç†æœºåˆ¶

### Hookç›®æ ‡å‡½æ•°

- `AssetBundle.LoadAssetAsync` - æ£€æµ‹èµ„æºåŠ è½½è¯·æ±‚
- `AssetBundleRequest.GetResult` - æ‰§è¡Œå®é™…æ›¿æ¢
- `Resources.Load` - å¤‡ç”¨èµ„æºåŠ è½½è·¯å¾„

### èµ„æºç±»å‹æ”¯æŒ

| ç±»å‹ | èµ„æºå‰ç¼€ | ç¤ºä¾‹ | çŠ¶æ€ |
|------|----------|------|------|
| æ¼«ç”» | `img_general_comic` | `img_general_comic_0001` | âœ… å®Œæ•´æ”¯æŒ |
| åŸ¹è‚²æŠ¥å‘Š | `img_general_report` | `img_general_report_text_ttmr-001` | âœ… å®Œæ•´æ”¯æŒ |
| UIæŒ‰é’® | `img_general_ui` | `img_general_ui_produce-1_btn-small` | âœ… å®Œæ•´æ”¯æŒ |
| æ•™ç¨‹ | `img_tutorial` | `img_tutorial_produce_01_first-001` | âœ… å®Œæ•´æ”¯æŒ |

## ğŸ“Š å®é™…å‘ç°çš„èµ„æº

é€šè¿‡æ¸¸æˆè¿è¡Œæ—¶æ£€æµ‹ï¼Œå‘ç°çš„çœŸå®èµ„æºåç§°ï¼š

### UIæŒ‰é’®èµ„æº
```
img_general_ui_produce-1_btn-small
img_general_ui_produce-2_btn-small  
img_general_ui_produce-3_btn-small
img_general_ui_produce-nia_btn
img_general_ui_produce-nia-2_btn
```

### Tutorialèµ„æº
```
img_tutorial_produce_01_first-001
img_tutorial_produce_01_first-002
```

### General Reportèµ„æºç±»å‹
- **æ–‡æœ¬å›¾åƒ**: `img_general_report_text_*`
- **ç…§ç‰‡åç§°**: `img_general_report_photo-name_*`  
- **èƒŒæ™¯å›¾è¡¨**: `img_general_report_bg_*`
- **è§’è‰²å¤´åƒ**: `img_general_report_akapen_*`

## ğŸ“‹ ä½¿ç”¨è¯´æ˜

### é…ç½®æ–‡ä»¶æ ¼å¼

**æ³¨æ„**: Releaseç‰ˆæœ¬å·²åŒ…å«é¢„é…ç½®çš„ `asset_mapping.txt` æ–‡ä»¶ï¼ŒåŒ…å«ä½œè€…ç¿»è¯‘çš„èµ„æºæ˜ å°„ã€‚

å¦‚éœ€è‡ªå®šä¹‰æˆ–æ·»åŠ æ›´å¤šç¿»è¯‘èµ„æºï¼Œ`asset_mapping.txt` ä½¿ç”¨ç®€å•çš„é”®å€¼å¯¹æ ¼å¼ï¼š
```ini
# æ³¨é‡Šä»¥ # å¼€å¤´
èµ„æºID=æœ¬åœ°æ–‡ä»¶è·¯å¾„

# æ”¯æŒçš„æ ¼å¼ç¤ºä¾‹
img_general_comic_0001=comic/1ko/my_comic_01.png
img_general_comic_0002=comic/1ko/my_comic_02.jpg
```

### æ”¯æŒçš„å›¾åƒæ ¼å¼
- PNG (æ¨è)
- JPG/JPEG
- å…¶ä»–Unityæ”¯æŒçš„æ ¼å¼

### æ—¥å¿—ç³»ç»Ÿ
- è‡ªåŠ¨ç”Ÿæˆå¸¦æ—¶é—´æˆ³çš„æ—¥å¿—æ–‡ä»¶
- ä½ç½®: `gakumas-local-texture/logs/`
- æ ¼å¼: `gakumas_texture_replace_YYYYMMDD_HHMMSS.log`

### æ€§èƒ½ä¼˜åŒ–è®¾ç½®
```cpp
// ç¼“å­˜è®¾ç½® (ç¼–è¯‘æ—¶å¸¸é‡)
MAX_CACHE_SIZE = 50          // æœ€å¤§ç¼“å­˜çº¹ç†æ•°é‡
CACHE_EXPIRE_TIME = 300000   // 5åˆ†é’Ÿè¿‡æœŸæ—¶é—´
PENDING_EXPIRE_TIME = 60000  // 1åˆ†é’Ÿå¾…å¤„ç†è¿‡æœŸæ—¶é—´
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç³»ç»Ÿæœªå¯åŠ¨**
   ```
   æ£€æŸ¥æ—¥å¿—: æ˜¯å¦æ£€æµ‹åˆ° "Target process detected: gakumas.exe"
   ç¡®è®¤è¿›ç¨‹å: åªåœ¨gakumas.exeä¸­æ¿€æ´»
   ```

2. **Hookå®‰è£…å¤±è´¥**
   ```
   æ£€æŸ¥æ—¥å¿—: "IL2CPP API initialization: SUCCESS"
   ç¡®è®¤æ¸¸æˆç‰ˆæœ¬: IL2CPPç»“æ„å¯èƒ½å˜åŒ–
   ```

3. **å›¾åƒä¸æ›¿æ¢**
   ```
   æ£€æŸ¥é…ç½®: asset_mapping.txt èµ„æºIDæ˜¯å¦æ­£ç¡®
   æ£€æŸ¥æ–‡ä»¶: æœ¬åœ°å›¾åƒæ–‡ä»¶æ˜¯å¦å­˜åœ¨
   æ£€æŸ¥æ—¥å¿—: æ˜¯å¦æœ‰ "REPLACEMENT MATCHED" æ¶ˆæ¯
   ```

### è°ƒè¯•æ¨¡å¼

ç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºæ§åˆ¶å°çª—å£æ˜¾ç¤ºå®æ—¶æ—¥å¿—ï¼Œæ ‡é¢˜ä¸ºï¼š
```
Gakumas - Comic + General Report + UI + Tutorial Replacement System (XInput Optimized)
```

### å®‰å…¨æ€§

- åªåœ¨ç›®æ ‡è¿›ç¨‹ä¸­æ¿€æ´»ï¼Œæ‹’ç»Unityè¾…åŠ©è¿›ç¨‹
- ä¸å½±å“å…³é”®ç³»ç»ŸAPI (ä½¿ç”¨XInputè€ŒéWinHTTP)
- å®Œæ•´çš„å¼‚å¸¸å¤„ç†ï¼Œé¿å…æ¸¸æˆå´©æºƒ
- æ™ºèƒ½å†…å­˜ç®¡ç†ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼

## ğŸ¤ å…¼å®¹æ€§

### ä¸å…¶ä»–Modçš„å…¼å®¹æ€§
- âœ… **chinosk version.dll**: å®Œç¾å¹¶è¡Œè¿è¡Œ
- âœ… **å…¶ä»–DLL Mod**: ä½¿ç”¨ä¸åŒDLLåç§°ï¼Œæ— å†²çª
- â“ **å…¶ä»–Hookç³»ç»Ÿ**: éœ€è¦å…·ä½“æµ‹è¯•

### æ¸¸æˆç‰ˆæœ¬å…¼å®¹æ€§
- å¼€å‘åŸºäº: Unity IL2CPPæ¶æ„
- ç†è®ºå…¼å®¹: æ‰€æœ‰ä½¿ç”¨ç›¸åŒå¼•æ“æ¶æ„çš„ç‰ˆæœ¬
- æ³¨æ„äº‹é¡¹: é‡å¤§æ¸¸æˆæ›´æ–°å¯èƒ½éœ€è¦é‡æ–°é€‚é…

## ğŸ“ˆ å¼€å‘å†ç¨‹

### æŠ€æœ¯æ¼”è¿›è·¯å¾„
1. **Version.dllç‰ˆæœ¬** â†’ **XInputç‰ˆæœ¬** (è§£å†³ç½‘ç»œé—®é¢˜)
2. **Comicæ”¯æŒ** â†’ **General Reportæ‰©å±•** â†’ **UI+Tutorialå…¨åŠŸèƒ½**
3. **æ€§èƒ½é—®é¢˜** â†’ **ä¼˜åŒ–ç›‘æ§ç­–ç•¥** â†’ **æ™ºèƒ½å†…å­˜ç®¡ç†**

### å…³é”®æŠ€æœ¯çªç ´
- IL2CPPæ–¹æ³•åœ°å€è§£æ (+0åç§»æ–¹æ¡ˆ)
- å»¶è¿Ÿæ›¿æ¢ç­–ç•¥ (é¿å…ç›´æ¥è¿”å›å´©æºƒ)
- Unityçº¹ç†åˆ›å»º (IL2CPPæ•°ç»„å†…å­˜å¸ƒå±€)
- åŒDLLå…¼å®¹è®¾è®¡

## ğŸ”® æœªæ¥è®¡åˆ’

### èµ„æºæ›´æ–°è®¡åˆ’
- ğŸ”„ **æŒç»­ç¿»è¯‘**: å®šæœŸæ›´æ–°gakumas-local-textureä¸­çš„ç¿»è¯‘èµ„æº
- ğŸ“¦ **Releaseæ›´æ–°**: æ¯æ¬¡èµ„æºæ›´æ–°åå‘å¸ƒæ–°çš„Releaseç‰ˆæœ¬
- ğŸŒ **ç¤¾åŒºè´¡çŒ®**: æ¬¢è¿ç¤¾åŒºè´¡çŒ®æ›´å¤šé«˜è´¨é‡ç¿»è¯‘èµ„æº

### çŸ­æœŸç›®æ ‡
- [ ] æ›´å¤šUIå…ƒç´ æ”¯æŒ (éæŒ‰é’®ç±»å‹)
- [ ] éŸ³é¢‘èµ„æºæ›¿æ¢ç³»ç»Ÿ
- [ ] é…ç½®çƒ­é‡è½½åŠŸèƒ½

### é•¿æœŸç›®æ ‡  
- [ ] å¯è§†åŒ–é…ç½®å·¥å…·
- [ ] èµ„æºåŒ…ç®¡ç†ç³»ç»Ÿ
- [ ] è‡ªåŠ¨åŒ–èµ„æºå‘ç°å·¥å…·

## ğŸ“š ç›¸å…³èµ„æº

### æŠ€æœ¯å‚è€ƒ
- [chinosk6/gakuen-imas-localify](https://github.com/chinosk6/gakuen-imas-localify) - åŸå§‹æ±‰åŒ–è¡¥ä¸
- [TsudaKageyu/minhook](https://github.com/TsudaKageyu/minhook) - Hookåº“
- [Unity IL2CPP Documentation](https://docs.unity3d.com/Manual/IL2CPP.html)

### å¼€å‘æ–‡æ¡£
- `prompt_md/` ç›®å½•åŒ…å«å®Œæ•´çš„å¼€å‘è®°å½•
- IDA Proåˆ†æç»“æœå’ŒæŠ€æœ¯ç»†èŠ‚
- è¯¦ç»†çš„é—®é¢˜è§£å†³æ–¹æ¡ˆè®°å½•

## âš–ï¸ è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ç”¨äºå­¦ä¹ å’Œç ”ç©¶ç›®çš„ã€‚è¯·éµå®ˆæ¸¸æˆæœåŠ¡æ¡æ¬¾å’Œç›¸å…³æ³•å¾‹æ³•è§„ã€‚

## ğŸ™ è‡´è°¢

- **chinosk**: æä¾›äº†å®è´µçš„æŠ€æœ¯å‚è€ƒå’Œæ±‰åŒ–è¡¥ä¸
- **TsudaKageyu**: MinHookåº“ä½œè€…
- **Unity Technologies**: IL2CPPæŠ€æœ¯æ–‡æ¡£

---

**é¡¹ç›®çŠ¶æ€**: âœ… ç¨³å®šè¿è¡Œ  
**æœ€åæ›´æ–°**: 2025å¹´6æœˆ14æ—¥  
**ç‰ˆæœ¬**: XInputä¼˜åŒ–ç‰ˆ v1.2
